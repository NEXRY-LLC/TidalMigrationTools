APPL SAPDBMNT WAIT


INVOKE 'SWS.ESP.APPL.PROCLIB(#DISTRIB)'
JCLLIB 'SWS.FTRSW.PRDJOBS'
JCLLIB 'FTRF.PRDJOBS'
NOTIFY ABEND FAILURE ALERT(REMD)

/*********************************************************************/
/* Special Event created for Legacy NA çBFPŸ                         */
/* This event will start maintenance of SAP and DB alone             */
/*********************************************************************/

JOB CONFIRM_SHUTDOWN_OF_SAP TASK PROCESS DOCMEM(SAPSHUT)
   RUN TODAY
   IF TODAY('Jan 13 2019') THEN JOBATTR HOLD
   RELEASE ADD(BASIS_SUSPEND_BFP_BATCH_ONE)
ENDJOB

SAP_JOB BASIS_SUSPEND_BFP_BATCH_ONE REQUEST
   AGENT CYBB_BFP030
   SAPJOBNAME BASIS_SUSPEND_BFP_BATCH
   SAPJOBCLASS A
   STARTMODE ASAP
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   RUN TODAY
   RELEASE ADD(BASIS_SUSPEND_BFP_BATCH_TWO)
ENDJOB

SAP_JOB BASIS_SUSPEND_BFP_BATCH_TWO REQUEST
   AGENT CYBB_BFP030
   SAPJOBNAME BASIS_SUSPEND_BFP_BATCH
   SAPJOBCLASS A
   STARTMODE ASAP
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   RUN TODAY
   RELDELAY 1
   IF TODAY('APR 30 2017') THEN JOBATTR HOLD
   RELEASE ADD(STOSAP25.SP2N25X)
   RELEASE ADD(STOSBFP3.ISBFP3)
   RELEASE ADD(STOSBFP5.ISBFP5)
   RELEASE ADD(STOSBFP6.ISBFP6)
   RELEASE ADD(STOSBFP2.ISBFP2X)
ENDJOB

UNIX_JOB STOSAP25.SP2N25X
   AGENT CYBA_SP2N25
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP3.ISBFP3
   AGENT CYBA_ISBFP3
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP2.ISBFP2X
   AGENT CYBA_ISBFP2
   /*@@ "/local/bin/stop_sap.sh BFP"*/
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP5.ISBFP5
   AGENT CYBA_ISBFP5
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   IF TODAY('APR 16 2017') THEN JOBATTR REQUEST
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP6.ISBFP6
   AGENT CYBA_ISBFP6
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   IF TODAY('APR 16 2017') THEN JOBATTR REQUEST
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP1.ISBFP1X
   AGENT CYBA_ISBFP1
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   RUN TODAY
   USER root
   RELEASE ADD(BFPSTOPD.SAPBFPDB)
ENDJOB

UNIX_JOB BFPSTOPD.SAPBFPDB
    AGENT CYBA_SAPBFPDB
    SCRIPTNAME /local/bin/stop_db2.sh
    ARGS BFP
    USER root
    RUN TODAY
    IF TODAY('AUG 7 2016') THEN JOBATTR REQUEST
    RELEASE ADD(BFPSTRTD.SAPBFPDB)
 ENDJOB

UNIX_JOB STASBFP1.ISBFP1X
   IF TODAY('JUL 19 2015') THEN JOBATTR HOLD
   AGENT CYBA_ISBFP1
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STASBFP3.ISBFP1X)
   RELEASE ADD(STASBFP2.ISBFP2X)
   RELEASE ADD(STASBFP5.ISBFP5)
   RELEASE ADD(STASBFP6.ISBFP6)
   RELEASE ADD(STASAP25.SP2N25X)
ENDJOB

UNIX_JOB STASBFP2.ISBFP2X
   AGENT CYBA_ISBFP2
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(BFP_STARTUP_IS_COMPLETE)
ENDJOB

JOB CONFIRM_RESTART_OF_DB2 TASK PROCESS DOCMEM(STARTDB2)
   SEND 'CONFIRM with DB2 Admin that DB2 can be restarted.'
   RUN TODAY
   RELEASE ADD(BFPSTRTD.SAPBFPDB)
ENDJOB

UNIX_JOB BFPSTRTD.SAPBFPDB
   AGENT CYBA_SAPBFPDB
   SCRIPTNAME /local/bin/start_db2.sh
   ARGS BFP
   USER root
   RUN TODAY
   IF TODAY('DEC 15 2019') THEN JOBATTR HOLD
   RELEASE ADD(BFPDBSNP.SAPBFPDB)
   RELEASE ADD(SETWRITE_RESUME_BFPDBSNP_TODAY)
ENDJOB

UNIX_JOB BFPDBSNP.SAPBFPDB
   AGENT CYBA_OPMAPP
   SCRIPTNAME /local/bin/create_snap.sh
   ARGS sapbfpdb BFP daily
   USER root
   RUN TODAY
   IF TODAY('JUL 16 2017') THEN JOBATTR REQUEST
   RELEASE ADD(DB2_MAINTENANCE_IS_COMPLETE)
ENDJOB

/* Return Codes for Job SETWRITE_RESUME_BFPDBSNP:
/*    0 Successful start
/*
/*    1 Invalid User ID
/*    2 Invalid number of parameters passed - acceptable ccchk.
/*    3 /db2/<SID> not found.  Bad parm?
/*    4 Database Connection Error
/*    5 Unknown error

UNIX_JOB SETWRITE_RESUME_BFPDBSNP_TODAY
  AGENT CYBA_SAPBFPDB
  SCRIPTNAME /local/bin/db2_Set_Write_Resume.sh
  ARGS BFP
  EXITCODE 0-1 FAILURE
  EXITCODE 2 SUCCESS
  EXITCODE 3-9099 FAILURE
  USER root
  RUN TODAY
  IF TODAY('JUL 16 2017') THEN JOBATTR REQUEST
  RELDELAY 8
  RELEASE ADD(DB2_MAINTENANCE_IS_COMPLETE)
ENDJOB

JOB DB2_MAINTENANCE_IS_COMPLETE LINK PROCESS
   TAG TODAYMAINT
   RELEASE ADD(CONFIRM_RESTART_OF_SAP)
   RUN TODAY
ENDJOB

JOB CONFIRM_RESTART_OF_SAP TASK PROCESS DOCMEM(SAPSTART)
  SEND 'CONFIRM THAT YOU ARE READY TO BRING SAP BACK UP - THEN +
ACKNOWLEDGE THIS PROMPT'
   TAG TODAYMAINT
  RUN TODAY
  IF TODAY('MAY 28 2017') THEN JOBATTR HOLD
  RELEASE ADD(STASBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STASBFP5.ISBFP5
   AGENT CYBA_ISBFP5
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   IF TODAY('APR 16 2017') THEN JOBATTR REQUEST
   RELEASE ADD(BFP_STARTUP_IS_COMPLETE)
ENDJOB

UNIX_JOB STASBFP6.ISBFP6
   AGENT CYBA_ISBFP6
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(BFP_STARTUP_IS_COMPLETE)
ENDJOB

UNIX_JOB STASBFP3.ISBFP1X
    AGENT CYBA_ISBFP1
    SCRIPTNAME /local/bin/start_sap_remote.sh
    ARGS isbfp3 BFP
    USER root
     TAG TODAYMAINT
    RUN TODAY
    RELEASE ADD(BFP_STARTUP_IS_COMPLETE)
ENDJOB

UNIX_JOB STASAP25.SP2N25X
   AGENT CYBA_SP2N25
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(BFP_STARTUP_IS_COMPLETE)
ENDJOB

JOB BFP_STARTUP_IS_COMPLETE LINK PROCESS
   TAG TODAYMAINT
   RUN TODAY
ENDJOB
