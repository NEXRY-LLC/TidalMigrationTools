APPL FALTMCHG WAIT HOLD

NOTIFY ABEND FAILURE ALERT(REMD)
INVOKE 'SWS.ESP.APPL.PROCLIB(#DISTRIB)'
JCLLIB 'SWS.FTRSW.PRDJOBS'

/*BFP -  Weekly schedule to:*/
/*1) Lock users, shutdown application servers, ICLI's, DB2.*/
/*2) Take offline snap backup.*/
/*3) Restart BFP.*/
/*4) Copy snap volumes to onsite and offsite tapes.*/
/*5) Create another set of snap volumes for Homogeneous System        +
   copies.*/
/**/
/*Note: there are 3 promts that need a reply:*/
/*1) To verify that no users are logged-on to BFP and there ar        +
  e no batch jobs*/
/*running.*/
/*2) To verify that the BFP DB2 system has shut down successfu        +
  lly.*/
/*3) To verify that you are ready to bring up the BFP system.*/

JOB SHUTDOWN_AND_RESTART_OF_WPS_AND_SAP_FOR_TIME_CHANGE LINK PROCESS
   RUN TODAY
   RELEASE ADD(BFPLOCK.SAPBFPDB)
ENDJOB

UNIX_JOB BFPLOCK.SAPBFPDB
    AGENT CYBA_SAPBFPDB
    SCRIPTNAME /local/bin/db2lock.sh
    ARGS BFP
    USER root
    RUN TODAY
    RELEASE ADD(CONFIRM_NO_USERS_OR_ACTIVE_JOBS_ON_SAP)
ENDJOB

JOB CONFIRM_NO_USERS_OR_ACTIVE_JOBS_ON_SAP +
TASK PROCESS DOCMEM(NOACTSAP)
   SEND 'CONFIRM THAT NO BFP USERS ARE ON AND THAT NO BATCH SAP JOBS +
ARE RUNNING AND VALIDATE WPS/SAP USERS ARE DISCONNECTED - THEN +
ACKNOWLEDGE THIS PROMPT.'
   RUN TODAY
   RELEASE ADD(CONFIRM_NO_WPS_ACTVITIY_ON_SAP)
ENDJOB

SAP_JOB BASIS_SUSPEND_BFP_BATCH_ONE
   AGENT CYBB_BFP030
   SAPJOBNAME BASIS_SUSPEND_BFP_BATCH
   SAPJOBCLASS A
   STARTMODE ASAP
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   RUN TODAY
   RELEASE ADD(BASIS_SUSPEND_BFP_BATCH_TWO)
ENDJOB

SAP_JOB BASIS_SUSPEND_BFP_BATCH_TWO
   AGENT CYBB_BFP030
   SAPJOBNAME BASIS_SUSPEND_BFP_BATCH
   SAPJOBCLASS A
   STARTMODE ASAP
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS1
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   RUN TODAY
   RELDELAY 1
   RELEASE ADD(STOSAP25.SP2N25X)
   RELEASE ADD(STOSBFP3.ISBFP3)
   RELEASE ADD(STOSBFP5.ISBFP5)
   RELEASE ADD(STOSBFP6.ISBFP6)
   RELEASE ADD(STOSBFP2.ISBFP2X)
ENDJOB

UNIX_JOB STOSAP25.SP2N25X
   AGENT CYBA_SP2N25
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP3.ISBFP3
   AGENT CYBA_ISBFP3
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP2.ISBFP2X
   AGENT CYBA_ISBFP2
   /*@@ "/local/bin/stop_sap.sh BFP"*/
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP5.ISBFP5
   AGENT CYBA_ISBFP5
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP6.ISBFP6
   AGENT CYBA_ISBFP6
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   RUN TODAY
   USER root
   RELEASE ADD(STOSBFP1.ISBFP1X)
ENDJOB

UNIX_JOB STOSBFP1.ISBFP1X
   AGENT CYBA_ISBFP1
   SCRIPTNAME /local/bin/stop_sap.sh
   ARGS BFP
   RUN TODAY
   USER root
   RELEASE ADD(STOP_SCHEDULING_AGENT)
   RELEASE ADD(BFPSTOPD.SAPBFPDB)
ENDJOB

UNIX_JOB STASBFP1.ISBFP1X
   IF TODAY('MAY 11 2014') THEN JOBATTR HOLD
   AGENT CYBA_ISBFP1
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(STASBFP3.ISBFP1X)
   RELEASE ADD(STASBFP2.ISBFP2X)
   RELEASE ADD(STASBFP5.ISBFP5)
   RELEASE ADD(STASBFP6.ISBFP6)
   RELEASE ADD(STASAP25.SP2N25X)
ENDJOB

UNIX_JOB STASBFP2.ISBFP2X
   AGENT CYBA_ISBFP2
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   IF TODAY('7TH DEC 2008') THEN JOBATTR HOLD
   RELEASE ADD(START_WPS)
ENDJOB

UNIX_JOB BFPSTOPD.SAPBFPDB
    AGENT CYBA_SAPBFPDB
    SCRIPTNAME /local/bin/stop_db2.sh
    ARGS BFP
    USER root
    RUN TODAY
 /* RELEASE ADD(BFPSTRTD.SAPBFPDB)
    RELEASE ADD(STOP_HERE_FOR_TIME_CHANGE)
 ENDJOB

JOB STOP_HERE_FOR_TIME_CHANGE LINK PROCESS
    RUN TODAY
    RELEASE ADD(BFPSTRTD.SAPBFPDB)
ENDJOB


UNIX_JOB BFPSTRTD.SAPBFPDB
    AGENT CYBA_SAPBFPDB
    SCRIPTNAME /local/bin/start_db2.sh
    ARGS BFP
    USER root
    RUN TODAY
    RELEASE ADD(BFPDBSNP.SAPBFPDB)
    RELEASE ADD(SETWRITE_RESUME_BFPDBSNP)
 ENDJOB

UNIX_JOB BFPDBSNP.SAPBFPDB
   AGENT CYBA_OPMAPP
   SCRIPTNAME /local/bin/create_snap.sh
   ARGS sapbfpdb BFP weekly
   USER root
   RUN TODAY
   RELEASE ADD(START_SAP)
ENDJOB

UNIX_JOB SETWRITE_RESUME_BFPDBSNP
  AGENT CYBA_SAPBFPDB
  SCRIPTNAME /local/bin/db2_Set_Write_Resume.sh
  ARGS BFP
  EXITCODE 0-1 FAILURE
  EXITCODE 2 SUCCESS
  EXITCODE 3-9099 FAILURE
  USER root
  RUN TODAY
  IF TODAY('AUG 7 2016') THEN JOBATTR REQUEST
  RELDELAY 8
  RELEASE ADD(START_SAP)
ENDJOB

JOB CONFIRM_RESTART_OF_SAP TASK PROCESS DOCMEM(SAPSTART)
  SEND 'CONFIRM THAT YOU ARE READY TO BRING SAP BACK UP - THEN +
ACKNOWLEDGE THIS PROMPT'
  RUN TODAY
  RELEASE ADD(START_SAP)
ENDJOB

UNIX_JOB STASBFP5.ISBFP5
   IF TODAY('JAN 26 2014') THEN JOBATTR HOLD
   AGENT CYBA_ISBFP5
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(START_WPS)
ENDJOB

UNIX_JOB STASBFP6.ISBFP6
   IF TODAY('JAN 26 2014') THEN JOBATTR HOLD
   AGENT CYBA_ISBFP6
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(START_WPS)
ENDJOB

 UNIX_JOB STASBFP3.ISBFP1X
     AGENT CYBA_ISBFP1
     SCRIPTNAME /local/bin/start_sap_remote.sh
     ARGS isbfp3 BFP
     USER root
     RUN TODAY
     RELEASE ADD(START_WPS)
 ENDJOB

AIX_JOB STOP_SCHEDULING_AGENT
   AGENT CYBA_ISBFP3
   USER root
   SCRIPTNAME /local/bin/stop_at_cybr.sh
   RUN TODAY
 /*RELEASE ADD(START_SCHEDULING_AGENT)
    RELEASE ADD(STOP_HERE_FOR_TIME_CHANGE)
ENDJOB

AIX_JOB START_SCHEDULING_AGENT
   AGENT CYBA_BKPNBU05
   USER root
   SCRIPTNAME /local/bin/start_remote_cyb_process.sh
   ARGS isbfp3
   RUN TODAY
   IF TODAY('JAN 13 2013') THEN JOBATTR HOLD
   RELEASE ADD(ISBFP3)
ENDJOB

JOB CONFIRM_RESTART_OF_SCHEDULING_AGENT TASK PROCESS DOCMEM(STARTESP)
   SEND 'CONFIRM restart of scheduling agent on ISBFP3'
   RUN TODAY
   RELEASE ADD(START_SCHEDULING_AGENT)
ENDJOB

JOB CONFIRM_CONNECTIONS_BETWEEN_WPS_AND_SAP_ARE_ACTIVE +
TASK PROCESS DOCMEM(WPSTOSAP)
   SEND 'Verify connections between WPS and SAP are active'
   RUN TODAY
   RELEASE ADD(PREPARE_TO_RESUME_BATCH_PROCESSING)
ENDJOB

JOB PREPARE_TO_RESUME_BATCH_PROCESSING LINK PROCESS
   RUN TODAY
   RELEASE ADD(START_SCHEDULING_AGENT)
ENDJOB

AIX_JOB ISBFP3
   AGENT CYBA_ISBFP3
   USER root
   SCRIPTNAME /local/bin/df.sh
   RUN TODAY
   RELDELAY  2
   RELEASE ADD(TP_SHOWBUFFER)
ENDJOB

UNIX_JOB STASAP25.SP2N25X
   AGENT CYBA_SP2N25
   SCRIPTNAME /local/bin/start_sap.sh
   ARGS BFP
   USER root
   RUN TODAY
   RELEASE ADD(START_WPS)
ENDJOB

JOB BFPULOCK
   MEMBER USIEBR14
   RUN TODAY
   RELEASE ADD(SHUTDOWN_AND_RESTART_FOR_TIME_CHANGE_COMPLETE)
ENDJOB

JOB SHUTDOWN_AND_RESTART_FOR_TIME_CHANGE_COMPLETE LINK PROCESS
   RUN TODAY
ENDJOB

AIX_JOB TP_SHOWBUFFER
   AGENT CYBA_ISBFP3
   USER bfpadm
   CMDNAME /sapmnt/BFP/exe/tp
   ARGS showbuffer BFP pf=/usr/sap/trans/bin/TPPARAM
   RUN TODAY
   RELEASE ADD(BASIS_RESUME_BFP_BATCH)
ENDJOB

SAP_JOB BASIS_RESUME_BFP_BATCH
   AGENT CYBB_BFP030
   SAPJOBNAME BASIS_RESUME_BFP_BATCH
   SAPJOBCLASS A
   STARTMODE ASAP
   ABAPNAME BTCTRNS2
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS2
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   ABAPNAME BTCTRNS2
   STEPUSER SAPADM
   LANGUAGE E
   PRINTDEST AK09
   EXPIRATION 8
   LINES 65
   COLUMNS 80
   BANNER D
   RECIPIENT SAPADM
   ARCMODE PRINT
   PRINTCOPIES 001
   RUN TODAY
   RELDELAY 2
   RELEASE ADD(BFPULCK1.SAPBFPDB)
ENDJOB

UNIX_JOB BFPULCK1.SAPBFPDB
    AGENT CYBA_SAPBFPDB
    SCRIPTNAME /local/bin/db2unlock.sh
    ARGS BFP
    USER root
    RUN TODAY
    RELEASE ADD(BFPULOCK)
ENDJOB

JOB BFPULOCK
   MEMBER USIEBR14
   RUN TODAY
   RELEASE ADD(LIE.WKLYBBFP)
ENDJOB

JOB SHUTDOWN_WPS LINK PROCESS
  RUN TODAY
  RELEASE ADD(STOP_WPSFILE_MOVES_FOR_WPSFIL01PAK)
ENDJOB

/*Former JOB WPSPRM1.PROMPT TASK PROCESS DOCMEM(WPSPRM1)
JOB CONFIRM_NO_WPS_ACTVITIY_ON_SAP TASK PROCESS DOCMEM(NOWPSACT)
   SEND 'Confirm NO WPS activity in SAP BFP then acknowledge prompt'
   RUN TODAY
   RELEASE ADD(SHUTDOWN_WPS)
   RELEASE ADD(SHUTDOWN_POP)
ENDJOB

LINUX_JOB STOP_WPSFILE_MOVES_FOR_WPSFIL01PAK
    AGENT WPSP_WPSFIL01PAK
    USER root
    SCRIPTNAME /usr/local/bin/stop_filerouter.sh
    RUN TODAY
    RELEASE ADD(STOP_WPSFILE_MOVES_FOR_DB2WPS01PAKR)
 ENDJOB

LINUX_JOB STOP_WPSFILE_MOVES_FOR_DB2WPS01PAKR
   AGENT DB2WPS01PAKR
   USER root
   SCRIPTNAME /usr/local/bin/stop_filerouter.sh
   RUN TODAY
   RELEASE ADD(STOP_CELL1_APPS)
   RELEASE ADD(STOP_CELL2_APPS)
ENDJOB

LINUX_JOB STOP_CELL1_APPS
   AGENT WPSP_WPSP20AKFIS
   USER root
   SCRIPTNAME /home/wasadmin/scripts/stop_start/AdminUtilApp.sh
   RUN TODAY
   RELEASE ADD(STOP_CELL1_CLUSTERS)
ENDJOB

LINUX_JOB STOP_CELL1_CLUSTERS
   AGENT WPSP_WPSP20AKFIS
   USER root
   SCRIPTNAME /usr/local/bin/wps_cluster_stop.sh
   RUN TODAY
   RELEASE ADD(CONFIRM_WPS_SHUTDOWN_COMPLETE)
ENDJOB

LINUX_JOB STOP_CELL2_APPS
   AGENT WPSP_WPSP30AKFIS
   USER root
   SCRIPTNAME /home/wasadmin/scripts/stop_start/AdminUtilApp.sh
   RUN TODAY
   RELEASE ADD(STOP_CELL2_CLUSTERS)
ENDJOB

LINUX_JOB STOP_CELL2_CLUSTERS
   AGENT WPSP_WPSP30AKFIS
   USER root
   SCRIPTNAME /usr/local/bin/wps_cluster_stop.sh
   RUN TODAY
   RELEASE ADD(CONFIRM_WPS_SHUTDOWN_COMPLETE)
   /*RELEASE ADD(DB2_OFFLINE_BACKUP)
ENDJOB

JOB CONFIRM_WPS_SHUTDOWN_COMPLETE TASK PROCESS DOCMEM(WPSDOWN)
   SEND 'Confirm WPS shutdown has comleted. Are you ready to start -
DB2 Offline Backup? If yes, then complete prompt.'
   RUN TODAY
   RELEASE ADD(SHUTDOWN_SAP)
ENDJOB

JOB SHUTDOWN_SAP LINK PROCESS
  RUN TODAY
  RELEASE ADD(BASIS_SUSPEND_BFP_BATCH_ONE)
ENDJOB

JOB CONFIRM_SHUTDOWN_OF_SAP TASK PROCESS DOCMEM(SAPSHUT)
   SEND 'Confirm that you are ready to shutdown SAP'
   RUN TODAY
   RELEASE ADD(BASIS_SUSPEND_BFP_BATCH_ONE)
ENDJOB

JOB CONFIRM_RESTART_OF_WPS_WITH_WPS_ADMIN +
TASK PROCESS DOCMEM(STARTWPS)
   SEND 'CONFIRM with WPS Admin that WPS can be restarted.'
   RUN TODAY
   RELEASE ADD(START_WPS)
ENDJOB

JOB CONFIRM_RESTART_OF_DB2 TASK PROCESS DOCMEM(STARTDB2)
   SEND 'CONFIRM with DB2 Admin that DB2 can be restarted.'
   RUN TODAY
   RELEASE ADD(BFPSTRTD.SAPBFPDB)
   RELEASE ADD(POPSTRTD.SAPPOPDB)
ENDJOB

JOB START_WPS LINK PROCESS
   RUN TODAY
   RELEASE ADD(START_CELL1_CLUSTERS)
   RELEASE ADD(START_CELL2_CLUSTERS)
ENDJOB

JOB START_SAP LINK PROCESS
   RUN TODAY
   RELEASE ADD(STASBFP1.ISBFP1X)
ENDJOB

LINUX_JOB START_CELL1_CLUSTERS
   AGENT WPSP_WPSP20AKFIS
   USER root
   SCRIPTNAME /usr/local/bin/wps_cluster_start.sh
   RUN TODAY
   RELEASE ADD(START_WPSFILE_MOVES_FOR_DB2WPS01PAKR)
ENDJOB

LINUX_JOB START_CELL2_CLUSTERS
   AGENT WPSP_WPSP30AKFIS
   USER root
   SCRIPTNAME /usr/local/bin/wps_cluster_start.sh
   RUN TODAY
   RELEASE ADD(START_WPSFILE_MOVES_FOR_DB2WPS01PAKR)
ENDJOB

LINUX_JOB START_WPSFILE_MOVES_FOR_DB2WPS01PAKR
   AGENT DB2WPS01PAKR
   USER root
   SCRIPTNAME /usr/local/bin/start_filerouter.sh
   RUN TODAY
   RELEASE ADD(START_WPSFILE_MOVES_FOR_WPSFIL01PAK)
 ENDJOB

LINUX_JOB START_WPSFILE_MOVES_FOR_WPSFIL01PAK
   AGENT WPSP_WPSFIL01PAK
   USER root
   SCRIPTNAME /usr/local/bin/start_filerouter.sh
   RUN TODAY
   RELEASE ADD(WPS_CLUSTER_DELAY)
   RELEASE ADD(CONFIRM_CONNECTIONS_BETWEEN_WPS_AND_SAP_ARE_ACTIVE)
ENDJOB

LINUX_JOB WPS_CLUSTER_DELAY
   AGENT WPSP_WPSP20AKFIS
   USER root
   SCRIPTNAME /usr/local/bin/wps_cluster_delay_start.sh
   RUN TODAY
   RELEASE ADD(WPS_STARTUP_COMPLETE)
ENDJOB

JOB WPS_STARTUP_COMPLETE LINK PROCESS
   RUN TODAY
   RELEASE ADD(SHUTDOWN_AND_RESTART_FOR_TIME_CHANGE_COMPLETE)
ENDJOB

                                                                        02850006


